
# 英语中考备考智能阅读平台 - 产品需求文档 (PRD)

| 项目属性 | 内容 |
| :--- | :--- |
| **项目名称** | 英语中考智能阅读平台 (Smart Reader) |
| **版本号** | **V1.3 (Final)** |
| **日期** | 2023-XX-XX |
| **核心理念** | 基于艾宾浩斯曲线的闭环式阅读训练 |
| **适用终端** | iPad (首选) / PC / Mac (Web Browser) |
| **技术核心** | React + Deepseek API + IndexedDB + Local Assets |

---

## 1. 项目背景与目标

### 1.1 项目背景
针对中考英语备考需求，开发一款单人使用的英语学习Web应用。系统旨在解决“单词背了就忘”和“阅读材料与词汇脱节”的痛点，通过智能算法将用户的生词和临界遗忘词汇编织成文章，实现“在阅读中记忆，在记忆中阅读”。

### 1.2 核心目标
1.  **科学记忆**：引入艾宾浩斯遗忘曲线算法，精准捕捉单词遗忘临界点。
2.  **内容生成**：利用大模型（Deepseek）生成符合中考考纲、贴合生活且包含目标词汇的阅读文章。
3.  **多维学习**：提供本地视频讲解辅助，打通“测-学-练”闭环。

---

## 2. 核心算法逻辑 (Core Algorithms) - **重点**

此部分是系统的“大脑”，决定了学习效率。

### 2.1 单词状态与记忆参数 (Word Schema)
每个单词在数据库中需维护以下关键字段，用于支撑间隔重复系统 (SRS)：
*   `status`: 单词状态
    *   **New**: 新词，从未接触。
    *   **Learning**: 学习中，处于遗忘曲线初期或刚做错。
    *   **Review**: 复习期，处于遗忘曲线的保持阶段。
    *   **Mastered**: 已掌握，间隔时间极长（如超过60天）。
*   `next_review_at`: (Timestamp) 下一次需要复习的具体时间点。
*   `interval`: (Number) 当前复习间隔天数 (如 1, 3, 7, 15...)。

### 2.2 艾宾浩斯复习调度算法
在用户完成**考试检查 (Module 1.3)** 后触发：
*   **Case A: 用户答对 (Correct)**
    *   `interval` 增长：若当前为0，变为1；若为1，变为3；以此类推（建议倍率 1.8x - 2.5x）。
    *   `next_review_at` 更新为：`当前时间 + interval (天)`。
    *   若 `interval` 超过设定阈值（如60天），`status` 变更为 `Mastered`。
*   **Case B: 用户答错 (Incorrect)**
    *   `interval` 重置：强制归零或重置为 1 天。
    *   `next_review_at` 更新为：`明天`。
    *   `status` 强制变更为 `Learning`。

### 2.3 动态选词生成算法
每次生成文章时，系统需选出 **N个核心词** (N=8~12)，优先级队列如下：
1.  **第一优先级：临界复习词 (Critical Review)**
    *   筛选条件：`status != Mastered` 且 `next_review_at <= 当前时间`。
    *   逻辑：这些词是“今天必须要复习”的，否则就会遗忘。
    *   占比：建议 **50% - 60%**。
2.  **第二优先级：新词推进 (New Words)**
    *   筛选条件：`status == New`。
    *   逻辑：推进学习进度。
    *   占比：建议 **30% - 40%**。
3.  **第三优先级：语感维持 (Maintenance)**
    *   筛选条件：`status == Mastered`。
    *   逻辑：填充剩余名额，保持语感。

---

## 3. 功能模块详情

### 模块一：文章生成与阅读 (Core)

#### 1.1 文章生成流程
用户点击“生成文章”时，需提供两种模式入口：

**模式 A：自动生成 (Automatic Mode)**
*   **逻辑**：系统“全托管”。直接调用 [2.3 动态选词算法] 选出 N 个词（数量由系统默认或设置决定），立即调用 API 生成文章。
*   **适用场景**：日常打卡，跟随系统进度学习。

**模式 B：手动生成 (Manual Mode)**
*   **Step 1: 参数设置**
    *   用户输入/拖动滑块设置**本次核心词数量** (例如：设为 15 个)。
*   **Step 2: 系统预选**
    *   系统基于 [2.3 动态选词算法] 推荐出 Top 15 个单词。
*   **Step 3: 单词编辑器 (Word Editor)**
    *   **展示**：以标签/列表形式展示这 15 个单词。
    *   **删除**：用户可点击 `x` 移除不想要的单词。
    *   **新增**：用户点击 `+` 按钮，弹窗搜索词库，手动添加特定单词（如：明天要考Unit 5，手动把Unit 5的生词加进去）。
    *   **补齐**：若用户删除了词导致数量不足，提供“自动补齐”按钮，系统再从算法队列里捞几个补上。
*   **Step 4: 确认生成**
    *   用户点击“确认生成”，系统锁定最终单词列表，调用 API。

#### 1.2 Deepseek Prompt 逻辑
*   **输入**：最终确定的核心词列表（无论来自自动还是手动）。
*   **指令**：
    *   必须包含列表中的所有核心词。
    *   核心词在文中需用 Markdown `**bold**` 加粗。
    *   长度遵循设置（短/中/长）。
    *   题材贴近初中生活。
    *   控制超纲词比例 < 10%。

#### 1.3 阅读界面
*   **展示**：简洁的阅读卡片。
*   **高亮**：核心词汇加粗显示。
*   **交互**：点击任意单词 -> 弹出 **[模块四：全局解释弹窗]**。

#### 1.4 考试检查 (Quiz)
*   **生成**：针对**本次核心词汇**生成试题。
*   **题型**：
    *   单项选择 (词义辨析)。
    *   选词填空 (Cloze)。
*   **交互**：
    *   **返回原文**：提供“返回原文”按钮，允许用户在提交前重新查看文章。
*   **提交**：用户作答后提交。

#### 1.5 结算与反馈
*   **系统动作**：
    *   自动判分。
    *   **核心：调用 [2.2 艾宾浩斯算法] 更新所有涉及单词的 `interval` 和 `next_review_at`。**
*   **用户动作**：
    *   对文章难易度打分 (1-5星)。
    *   若打分“太难”，系统将在下次生成时减少 `New` 词比例；若“太简单”，增加 `New` 词比例。
*   **保存**：将文章、题目、答案、分数完整归档。

### 模块二：学习记录 (Dashboard)

#### 2.1 仪表盘
*   **待复习词数**：显示今日 `next_review_at <= Now` 的单词数量（强提醒）。
*   **记忆曲线状态**：可视化展示有多少词处于“即将遗忘”状态。
*   **基础数据**：累计阅读篇数、累计掌握单词数、平均分。

#### 2.2 历史归档
*   时间轴展示生成的文章历史。
*   **列表项**：显示文章标题、生成时间、得分及核心词汇预览。
*   支持点击查看当时的错题和原文。

### 模块三：单词本 (Vocabulary Book)

#### 3.1 单词管理
*   **Tab 分类统计**：在顶部 Tab 栏 (All/New/Learning/Review/Mastered) 直接显示各状态下的单词数量，如 "New (15)"。
*   **列表展示**：显示单词拼写、音标、释义、当前状态。
*   **视觉标记**：
    *   使用进度条或颜色（红/黄/绿）表示记忆强度（基于 `interval` 大小）。
    *   高亮显示“今日需复习”的单词。
*   **操作**：支持搜索；支持手动修改状态（如：误判为生词，手动改为 Mastered）。

### 模块四：全局单词解释 (Global Lookup & Video)

#### 4.1 触发入口
*   阅读页划词/点击。
*   顶部导航栏搜索。

#### 4.2 单词详情模态框 (Modal)
*   **基本信息**：拼写、音标、TTS 发音、释义、例句。
*   **核心功能：本地视频讲解**
    *   **UI**：嵌入式视频播放器区域。
    *   **逻辑**：
        1.  获取当前单词（例如 `apple`）。
        2.  尝试加载本地资源：`/public/videos/apple.mp4` (需统一小写)。
        3.  **成功**：直接在模态框内自动或手动播放，**不跳转页面**。
        4.  **失败**：显示“暂无视频讲解”提示图。

### 模块五：设置 (Settings)

#### 5.1 基础配置
*   **API Key**：Deepseek API Key 输入框。

#### 5.2 数据管理
*   **重置进度**：
    *   **功能描述**：清除所有学习进度和历史记录，但保留单词基础数据和用户设置。
    *   **触发方式**：点击"重置进度"按钮，弹出确认对话框。
    *   **安全验证**：要求用户输入密码 `admin` 进行二次确认（防止误操作）。
    *   **操作范围**：
        *   **清除内容**：
            *   所有单词的学习状态（`status` 重置为 `New`）
            *   所有单词的复习数据（`nextReviewAt`、`interval`、`repetitionCount`、`lastSeenAt` 清零）
            *   所有学习历史记录（`history` 表清空）
        *   **保留内容**：
            *   单词基础数据（`spelling`、`phonetic`、`meaning`）
            *   用户设置（API Key、文章长度偏好、每日新词上限）
    *   **用户反馈**：操作成功后显示提示信息，页面自动刷新以应用更改。

#### 5.3 学习偏好
*   **文章长度 (Article Length)**：
    *   **短篇 (Short)**: ~150词 (适合碎片时间/快速复习)。
    *   **中篇 (Medium)**: ~250词 (默认，标准中考阅读长度)。
    *   **长篇 (Long)**: ~350+词 (强化训练)。
*   **每日新词上限**：限制每天引入 `New` 状态单词的最大数量（防止压力过大）。

---

## 4. UI/UX 设计规范

### 4.1 导航系统 (Navigation System)
*   **首页 (Home)**: 仪表盘与文章生成入口。
*   **阅读历史 (Reading History)**: 展示所有阅读历史记录列表。点击单条记录可重新进入阅读页面查看原文及做题情况。
*   **单词本 (Vocabulary Book)**: 单词列表与管理。
*   **统计 (Statistics)**: 学习数据可视化图表。
*   **设置 (Settings)**: 系统配置。

### 4.2 视觉风格
*   **风格**：**Google Material Design 3 (M3)**。
*   **配色**：
    *   Primary: Deep Blue / Teal (沉稳，专注)。
    *   Surface: Cream / Off-white (护眼阅读底色)。
    *   Alert: Red (错题/急需复习)。
*   **布局**：
    *   **iPad**: 侧边栏导航 + 大卡片内容区，触控友好。
    *   **PC**: 响应式布局，利用屏幕宽度并排显示“文章”和“题目”。

---

## 5. 数据模型 (Data Schema Recommendation)

建议使用 JSON 结构存储于 **IndexedDB**。

**1. Settings**
```json
{
  "api_key": "sk-...",
  "article_len_pref": "medium", // short, medium, long
  "daily_new_limit": 10
}
```

**2. Words (核心表)**
```json
{
  "id": "uuid",
  "spelling": "ambitious",
  "meaning": "adj. 有雄心的",
  "status": "review",        // new, learning, review, mastered
  "next_review_at": 1701234567890, // Timestamp
  "interval": 3,             // Days
  "repetition_count": 5,     // 复习次数
  "last_seen_at": 1701000000000
}
```

**3. History**
```json
{
  "id": "uuid",
  "date": 1701234567890,
  "title": "The Article Title",
  "articleContent": "...",
  "targetWords": ["ambitious", "plan", ...],
  "questions_json": [...],
  "user_score": 80,
  "difficulty_feedback": 3
}
```

---

## 6. 开发实施建议 (Technical Notes)

1.  **本地视频资源规范**：
    *   在项目根目录 `public/` 下建立 `videos/` 文件夹。
    *   视频文件名严格统一为**小写单词.mp4** (如 `information.mp4`)。
    *   前端组件通过 `onError` 事件监听视频加载失败，从而切换显示“暂无视频”的 UI。
2.  **API 请求优化**：
    *   Deepseek 生成文章和题目建议分为两步，或者在一次 Prompt 中要求返回严格的 JSON 格式（包含 `article_text` 和 `questions_array`），以便前端解析。
3.  **算法初始化**：
    *   首次使用时，需导入一份基础词库（中考考纲词汇）。初始状态全为 `New`，或者允许用户勾选“已认识的词”直接标记为 `Mastered`。